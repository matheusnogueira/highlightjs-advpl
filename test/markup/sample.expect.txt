<span class="hljs-keyword">LOAD</span> <span class="hljs-keyword">CSV</span> <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">HEADERS</span> <span class="hljs-keyword">FROM</span> <span class="hljs-string">"https://dl.dropboxusercontent.com/u/14493611/movies_setup.csv"</span> <span class="hljs-keyword">AS</span> row
<span class="hljs-keyword">MERGE</span> (m:<span class="hljs-type">Movie</span> {title:row.title}) <span class="hljs-keyword">ON</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">SET</span> m.released =<span class="hljs-functionCall"> toInt(row.released)</span>, m.tagline = row.tagline
<span class="hljs-keyword">MERGE</span> (p:<span class="hljs-type">Person</span>  {name:row.name}) <span class="hljs-keyword">ON</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">SET</span> p.born     =<span class="hljs-functionCall"> toInt(row.born)</span> <span class="hljs-keyword">WITH</span> m,p,row <span class="hljs-keyword">WHERE</span> row.type = <span class="hljs-string">"ACTED_IN"</span>
<span class="hljs-keyword">MERGE</span> (p)-[r:<span class="hljs-type">ACTED_IN</span>]-&gt;(m) <span class="hljs-keyword">ON</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">SET</span> r.roles =<span class="hljs-functionCall"> <span class="hljs-built_in">split</span>(row.roles,";")</span>[<span class="hljs-number">0.</span>.<span class="hljs-number">-1</span>]

<span class="hljs-keyword">LOAD</span> <span class="hljs-keyword">CSV</span> <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">HEADERS</span> <span class="hljs-keyword">FROM</span> <span class="hljs-string">"https://dl.dropboxusercontent.com/u/14493611/movies_setup.csv"</span> <span class="hljs-keyword">AS</span> row
<span class="hljs-keyword">MERGE</span> (m:<span class="hljs-type">Movie</span> {title:row.title}) <span class="hljs-keyword">ON</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">SET</span> m.tagline = row.tagline,m.released=row.released
<span class="hljs-keyword">MERGE</span> (p:<span class="hljs-type">Person</span> {name:row.name}) <span class="hljs-keyword">ON</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">SET</span> p.born = row.born

<span class="hljs-keyword">FOREACH</span> (_ <span class="hljs-keyword">in</span> <span class="hljs-keyword">CASE</span> row.type <span class="hljs-keyword">WHEN</span> <span class="hljs-string">"ACTED_IN"</span> <span class="hljs-keyword">then</span> [<span class="hljs-number">1</span>] <span class="hljs-keyword">else</span> [] <span class="hljs-keyword">end</span> | <span class="hljs-keyword">MERGE</span> (p)-[r:<span class="hljs-type">ACTED_IN</span>]-&gt;(m) <span class="hljs-keyword">ON</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">SET</span> r.roles =<span class="hljs-functionCall"> <span class="hljs-built_in">split</span>(row.roles,";")</span>[<span class="hljs-number">0.</span>.<span class="hljs-number">-1</span>])
<span class="hljs-keyword">FOREACH</span> (_ <span class="hljs-keyword">in</span> <span class="hljs-keyword">CASE</span> row.type <span class="hljs-keyword">WHEN</span> <span class="hljs-string">"DIRECTED"</span> <span class="hljs-keyword">then</span> [<span class="hljs-number">1</span>] <span class="hljs-keyword">else</span> [] <span class="hljs-keyword">end</span> | <span class="hljs-keyword">MERGE</span> (p)-[:<span class="hljs-type">DIRECTED</span>]-&gt;(m))
<span class="hljs-keyword">FOREACH</span> (_ <span class="hljs-keyword">in</span> <span class="hljs-keyword">CASE</span> row.type <span class="hljs-keyword">WHEN</span> <span class="hljs-string">"PRODUCED"</span> <span class="hljs-keyword">then</span> [<span class="hljs-number">1</span>] <span class="hljs-keyword">else</span> [] <span class="hljs-keyword">end</span> | <span class="hljs-keyword">MERGE</span> (p)-[:<span class="hljs-type">PRODUCED</span>]-&gt;(m))
<span class="hljs-keyword">FOREACH</span> (_ <span class="hljs-keyword">in</span> <span class="hljs-keyword">CASE</span> row.type <span class="hljs-keyword">WHEN</span> <span class="hljs-string">"WROTE"</span>    <span class="hljs-keyword">then</span> [<span class="hljs-number">1</span>] <span class="hljs-keyword">else</span> [] <span class="hljs-keyword">end</span> | <span class="hljs-keyword">MERGE</span> (p)-[:<span class="hljs-type">WROTE</span>   ]-&gt;(m))
<span class="hljs-keyword">FOREACH</span> (_ <span class="hljs-keyword">in</span> <span class="hljs-keyword">CASE</span> row.type <span class="hljs-keyword">WHEN</span> <span class="hljs-string">"REVIEWED"</span> <span class="hljs-keyword">then</span> [<span class="hljs-number">1</span>] <span class="hljs-keyword">else</span> [] <span class="hljs-keyword">end</span> | <span class="hljs-keyword">MERGE</span> (p)-[:<span class="hljs-type">REVIEWED</span>]-&gt;(m))
